*************************** 运行时间： 2025-01-08 17:53:52 ***************************
---------------------------------- 定义参数值 ----------------------------------
DONE
---------------------------------- 准备工作 ----------------------------------
初始数据占MNIST的比例：0.1%
model initing...
Epoch 1/5 started...
Epoch [1/5], Batch [1/1], Loss: 4.7275
Epoch 1 completed. Average Loss: 4.7275
Epoch 2/5 started...
Epoch [2/5], Batch [1/1], Loss: 44.3072
Epoch 2 completed. Average Loss: 44.3072
Epoch 3/5 started...
Epoch [3/5], Batch [1/1], Loss: 48.0244
Epoch 3 completed. Average Loss: 48.0244
Epoch 4/5 started...
Epoch [4/5], Batch [1/1], Loss: 24.7557
Epoch 4 completed. Average Loss: 24.7557
Epoch 5/5 started...
Epoch [5/5], Batch [1/1], Loss: 10.7945
Epoch 5 completed. Average Loss: 10.7945
Model saved to ./data/model/mnist_cnn_test
初始化模型的准确率：
Accuracy: 51.75%
DONE
==================================== literation: 1 ====================================
---------------------------------- 计算 DataOwner 的数据质量 ----------------------------------
DataOwner1: noise random: 0.08506047077688621
DataOwner2: noise random: 0.0977049460744033
DataOwner3: noise random: 0.03990932974555154
DataOwner4: noise random: 0.05202519482581053
DataOwner5: noise random: 0.026633102073680838
DataOwner1: Image 1: MSE = 0.0029, SNR = 18.12 dB
DataOwner2: Image 1: MSE = 0.0041, SNR = 15.68 dB
DataOwner3: Image 1: MSE = 0.0007, SNR = 25.13 dB
DataOwner4: Image 1: MSE = 0.0009, SNR = 24.05 dB
DataOwner5: Image 1: MSE = 0.0003, SNR = 30.51 dB
DONE
---------------------------------- 计算 ModelOwner 总体支付和 DataOwners 最优数据量 ----------------------------------
Stackelberg均衡结果：
ModelOwner的最优Eta = 0.0956
DataOwner1的最优x_1 = 0.0152
DataOwner2的最优x_2 = 0.0152
DataOwner3的最优x_3 = 0.0153
DataOwner4的最优x_4 = 0.0153
DataOwner5的最优x_5 = 0.0154
每个DataOwner应该贡献数据比例 xn_list = [0.015234647496694727, 0.015182070567814572, 0.015337357142383469, 0.015328613278063617, 0.015357211260620323]
ModelOwner的最大效用 U(Eta) = -0.0588
DONE
---------------------------------- DataOwner 分配 ModelOwner 的支付 ----------------------------------
ModelOwner的最优总支付：0.09555070669616049
DataOwner1的分配到的支付 ： 0.0190
DataOwner2的分配到的支付 ： 0.0189
DataOwner3的分配到的支付 ： 0.0192
DataOwner4的分配到的支付 ： 0.0192
DataOwner5的分配到的支付 ： 0.0192
DONE
---------------------------------- 匹配 DataOwner 和 CPC ----------------------------------
{'DataOwner1': 'CPC2', 'DataOwner5': 'CPC1', 'DataOwner2': 'CPC3', 'DataOwner3': 'CPC4', 'DataOwner4': 'CPC5'}
DONE
---------------------------------- DataOwner 向 CPC 提交数据 ----------------------------------
DataOwner1 把数据交给 CPC2
DataOwner5 把数据交给 CPC1
DataOwner2 把数据交给 CPC3
DataOwner3 把数据交给 CPC4
DataOwner4 把数据交给 CPC5
DONE
---------------------------------- 模型训练 ----------------------------------
正在评估DataOwner1的数据质量, 本轮评估的样本数据量为：166.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 51.75%
Epoch 1/5, Loss: 2.2971
Epoch 2/5, Loss: 2.2957
Epoch 3/5, Loss: 2.2945
Epoch 4/5, Loss: 2.2894
Epoch 5/5, Loss: 2.2919
新模型评估：
Accuracy: 54.68%
loss差为：
0.005205074946085464
单位数据loss差为：
3.135587316918954e-05
正在评估DataOwner5的数据质量, 本轮评估的样本数据量为：335.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 51.75%
Epoch 1/5, Loss: 2.2875
Epoch 2/5, Loss: 2.2877
Epoch 3/5, Loss: 2.2858
Epoch 4/5, Loss: 2.2812
Epoch 5/5, Loss: 2.2769
新模型评估：
Accuracy: 56.59%
loss差为：
0.010656118392944336
单位数据loss差为：
3.180930863565473e-05
正在评估DataOwner2的数据质量, 本轮评估的样本数据量为：248.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 51.75%
Epoch 1/5, Loss: 2.2984
Epoch 2/5, Loss: 2.2961
Epoch 3/5, Loss: 2.2956
Epoch 4/5, Loss: 2.2943
Epoch 5/5, Loss: 2.2928
新模型评估：
Accuracy: 56.27%
loss差为：
0.005581855773925781
单位数据loss差为：
2.250748295937815e-05
正在评估DataOwner3的数据质量, 本轮评估的样本数据量为：83.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 51.75%
Epoch 1/5, Loss: 2.3092
Epoch 2/5, Loss: 2.3266
Epoch 3/5, Loss: 2.3124
Epoch 4/5, Loss: 2.3279
Epoch 5/5, Loss: 2.3030
新模型评估：
Accuracy: 53.49%
loss差为：
0.0061386823654174805
单位数据loss差为：
7.396002849900578e-05
正在评估DataOwner4的数据质量, 本轮评估的样本数据量为：83.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 51.75%
Epoch 1/5, Loss: 2.2957
Epoch 2/5, Loss: 2.2850
Epoch 3/5, Loss: 2.3079
Epoch 4/5, Loss: 2.2938
Epoch 5/5, Loss: 2.2856
新模型评估：
Accuracy: 53.98%
loss差为：
0.01016998291015625
单位数据loss差为：
0.00012252991458019578
CPC2调整模型中, 本轮训练的数据量为：166.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 51.75%
Epoch 1/5, Loss: 2.2995
Epoch 2/5, Loss: 2.2938
Epoch 3/5, Loss: 2.2942
Epoch 4/5, Loss: 2.2952
Epoch 5/5, Loss: 2.2942
新模型评估：
Accuracy: 54.62%
Model saved to ./data/model/mnist_cnn_test
CPC1调整模型中, 本轮训练的数据量为：335.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 54.62%
Epoch 1/5, Loss: 2.2806
Epoch 2/5, Loss: 2.2767
Epoch 3/5, Loss: 2.2826
Epoch 4/5, Loss: 2.2806
Epoch 5/5, Loss: 2.2671
新模型评估：
Accuracy: 57.43%
Model saved to ./data/model/mnist_cnn_test
CPC3调整模型中, 本轮训练的数据量为：248.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 57.43%
Epoch 1/5, Loss: 2.2854
Epoch 2/5, Loss: 2.2825
Epoch 3/5, Loss: 2.2803
Epoch 4/5, Loss: 2.2779
Epoch 5/5, Loss: 2.2754
新模型评估：
Accuracy: 58.93%
Model saved to ./data/model/mnist_cnn_test
CPC4调整模型中, 本轮训练的数据量为：83.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 58.93%
Epoch 1/5, Loss: 2.2925
Epoch 2/5, Loss: 2.2852
Epoch 3/5, Loss: 2.2841
Epoch 4/5, Loss: 2.3114
Epoch 5/5, Loss: 2.2877
新模型评估：
Accuracy: 59.71%
Model saved to ./data/model/mnist_cnn_test
CPC5调整模型中, 本轮训练的数据量为：83.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 59.71%
Epoch 1/5, Loss: 2.2655
Epoch 2/5, Loss: 2.2643
Epoch 3/5, Loss: 2.2618
Epoch 4/5, Loss: 2.2570
Epoch 5/5, Loss: 2.2515
新模型评估：
Accuracy: 60.09%
Model saved to ./data/model/mnist_cnn_test
DONE
==================================== literation: 2 ====================================
---------------------------------- 计算 DataOwner 的数据质量 ----------------------------------
DONE
---------------------------------- 计算 ModelOwner 总体支付和 DataOwners 最优数据量 ----------------------------------
Stackelberg均衡结果：
ModelOwner的最优Eta = 0.2151
DataOwner1的最优x_1 = 0.0031
DataOwner2的最优x_2 = -0.1101
DataOwner3的最优x_3 = 0.0523
DataOwner4的最优x_4 = 0.0406
DataOwner5的最优x_5 = 0.0060
每个DataOwner应该贡献数据比例 xn_list = [0.0030673928096139496, -0.11013208086488843, 0.05231496087855985, 0.04056112301430683, 0.005958903526665193]
ModelOwner的最大效用 U(Eta) = -0.2151
DONE
---------------------------------- DataOwner 分配 ModelOwner 的支付 ----------------------------------
ModelOwner的最优总支付：0.21506954922534027
DataOwner1的分配到的支付 ： 0.0031
DataOwner2的分配到的支付 ： -0.0802
DataOwner3的分配到的支付 ： 0.1252
DataOwner4的分配到的支付 ： 0.1608
DataOwner5的分配到的支付 ： 0.0061
DONE
---------------------------------- 匹配 DataOwner 和 CPC ----------------------------------
{'DataOwner1': 'CPC1', 'DataOwner2': 'CPC2', 'DataOwner3': 'CPC3', 'DataOwner4': 'CPC4', 'DataOwner5': 'CPC5'}
DONE
---------------------------------- DataOwner 向 CPC 提交数据 ----------------------------------
DataOwner1 把数据交给 CPC1
DataOwner2 把数据交给 CPC2
DataOwner3 把数据交给 CPC3
DataOwner4 把数据交给 CPC4
DataOwner5 把数据交给 CPC5
DONE
---------------------------------- 模型训练 ----------------------------------
CPC1调整模型中, 本轮训练的数据量为：33.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 60.09%
Epoch 1/5, Loss: 2.2606
Epoch 2/5, Loss: 2.2595
Epoch 3/5, Loss: 2.2584
Epoch 4/5, Loss: 2.2573
Epoch 5/5, Loss: 2.2561
新模型评估：
Accuracy: 59.95%
CPC2调整模型中, 本轮训练的数据量为：0.00 :
数据量为0，跳过此轮调整
CPC3调整模型中, 本轮训练的数据量为：285.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 60.09%
Epoch 1/5, Loss: 2.2513
Epoch 2/5, Loss: 2.2440
Epoch 3/5, Loss: 2.2407
Epoch 4/5, Loss: 2.2339
Epoch 5/5, Loss: 2.2307
新模型评估：
Accuracy: 61.23%
Model saved to ./data/model/mnist_cnn_test
CPC4调整模型中, 本轮训练的数据量为：221.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 61.23%
Epoch 1/5, Loss: 2.2301
Epoch 2/5, Loss: 2.2163
Epoch 3/5, Loss: 2.2198
Epoch 4/5, Loss: 2.2201
Epoch 5/5, Loss: 2.2055
新模型评估：
Accuracy: 61.76%
Model saved to ./data/model/mnist_cnn_test
CPC5调整模型中, 本轮训练的数据量为：130.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 61.76%
Epoch 1/5, Loss: 2.2307
Epoch 2/5, Loss: 2.1981
Epoch 3/5, Loss: 2.1925
Epoch 4/5, Loss: 2.2104
Epoch 5/5, Loss: 2.2387
新模型评估：
Accuracy: 62.15%
Model saved to ./data/model/mnist_cnn_test
DONE
*************************** 运行时间： 2025-01-08 17:56:21 ***************************
---------------------------------- 定义参数值 ----------------------------------
DONE
---------------------------------- 准备工作 ----------------------------------
初始数据占MNIST的比例：0.1%
model initing...
Epoch 1/5 started...
Epoch [1/5], Batch [1/1], Loss: 5.5520
Epoch 1 completed. Average Loss: 5.5520
Epoch 2/5 started...
Epoch [2/5], Batch [1/1], Loss: 136.0855
Epoch 2 completed. Average Loss: 136.0855
Epoch 3/5 started...
Epoch [3/5], Batch [1/1], Loss: 103.1615
Epoch 3 completed. Average Loss: 103.1615
Epoch 4/5 started...
Epoch [4/5], Batch [1/1], Loss: 40.0451
Epoch 4 completed. Average Loss: 40.0451
Epoch 5/5 started...
Epoch [5/5], Batch [1/1], Loss: 16.9913
Epoch 5 completed. Average Loss: 16.9913
Model saved to ./data/model/mnist_cnn_test
初始化模型的准确率：
Accuracy: 23.40%
DONE
==================================== literation: 1 ====================================
---------------------------------- 计算 DataOwner 的数据质量 ----------------------------------
DataOwner1: noise random: 0.09628292081820797
DataOwner2: noise random: 0.005729557444264677
DataOwner3: noise random: 0.07836725650100165
DataOwner4: noise random: 0.00036977016367335526
DataOwner5: noise random: 0.05842988436646211
DataOwner1: Image 1: MSE = 0.0039, SNR = 16.11 dB
DataOwner2: Image 1: MSE = 0.0000, SNR = 43.75 dB
DataOwner3: Image 1: MSE = 0.0020, SNR = 20.40 dB
DataOwner4: Image 1: MSE = 0.0000, SNR = 62.86 dB
DataOwner5: Image 1: MSE = 0.0014, SNR = 21.80 dB
DONE
---------------------------------- 计算 ModelOwner 总体支付和 DataOwners 最优数据量 ----------------------------------
Stackelberg均衡结果：
ModelOwner的最优Eta = 0.0961
DataOwner1的最优x_1 = 0.0153
DataOwner2的最优x_2 = 0.0154
DataOwner3的最优x_3 = 0.0153
DataOwner4的最优x_4 = 0.0154
DataOwner5的最优x_5 = 0.0154
每个DataOwner应该贡献数据比例 xn_list = [0.015254284943297376, 0.015435910163984976, 0.015342167489021074, 0.0154364250398169, 0.015372137780047397]
ModelOwner的最大效用 U(Eta) = -0.0591
DONE
---------------------------------- DataOwner 分配 ModelOwner 的支付 ----------------------------------
ModelOwner的最优总支付：0.09605198312436691
DataOwner1的分配到的支付 ： 0.0190
DataOwner2的分配到的支付 ： 0.0193
DataOwner3的分配到的支付 ： 0.0192
DataOwner4的分配到的支付 ： 0.0193
DataOwner5的分配到的支付 ： 0.0192
DONE
---------------------------------- 匹配 DataOwner 和 CPC ----------------------------------
{'DataOwner1': 'CPC2', 'DataOwner2': 'CPC1', 'DataOwner3': 'CPC3', 'DataOwner4': 'CPC4', 'DataOwner5': 'CPC5'}
DONE
---------------------------------- DataOwner 向 CPC 提交数据 ----------------------------------
DataOwner1 把数据交给 CPC2
DataOwner2 把数据交给 CPC1
DataOwner3 把数据交给 CPC3
DataOwner4 把数据交给 CPC4
DataOwner5 把数据交给 CPC5
DONE
---------------------------------- 模型训练 ----------------------------------
正在评估DataOwner1的数据质量, 本轮评估的样本数据量为：281.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 23.40%
Epoch 1/5, Loss: 2.2966
Epoch 2/5, Loss: 2.2964
Epoch 3/5, Loss: 2.2978
Epoch 4/5, Loss: 2.2905
Epoch 5/5, Loss: 2.2937
新模型评估：
Accuracy: 24.39%
loss差为：
0.0029191493988038886
单位数据loss差为：
1.0388432024213126e-05
正在评估DataOwner2的数据质量, 本轮评估的样本数据量为：71.00 :
Model loaded from ./data/model/mnist_cnn_test
原模型评估：
Accuracy: 23.40%
Epoch 1/5, Loss: 2.3019
Epoch 2/5, Loss: 2.3164
Epoch 3/5, Loss: 2.3105
Epoch 4/5, Loss: 2.3095
Epoch 5/5, Loss: 2.2975
新模型评估：
